From e760b89280f06668375dbffa24640332648c67c7 Mon Sep 17 00:00:00 2001
From: Peter Lemenkov <lemenkov@gmail.com>
Date: Sun, 15 May 2011 18:47:41 +0400
Subject: [PATCH 5/8] Don't use bundled libraries

Signed-off-by: Peter Lemenkov <lemenkov@gmail.com>
---
 configure.ac               | 7 -------
 src/Makefile.am            | 2 +-
 src/ejson/Makefile.am      | 8 ++------
 test/etap/test_util.erl.in | 3 +--
 4 files changed, 4 insertions(+), 16 deletions(-)

diff --git a/configure.ac b/configure.ac
index 5ce0e96..d0a10ae 100644
--- a/configure.ac
+++ b/configure.ac
@@ -20,7 +20,6 @@ AC_CONFIG_AUX_DIR([build-aux])
 AC_CONFIG_MACRO_DIR([m4])
 
 AM_CONFIG_HEADER([config.h])
-AC_CONFIG_HEADERS([src/snappy/google-snappy/config.h])
 
 AM_INIT_AUTOMAKE([1.6.3 foreign])
 
@@ -599,12 +598,6 @@ AC_CONFIG_FILES([src/Makefile])
 AC_CONFIG_FILES([src/couchdb/couch.app.tpl])
 AC_CONFIG_FILES([src/couchdb/Makefile])
 AC_CONFIG_FILES([src/couchdb/priv/Makefile])
-AC_CONFIG_FILES([src/erlang-oauth/Makefile])
-AC_CONFIG_FILES([src/etap/Makefile])
-AC_CONFIG_FILES([src/ibrowse/Makefile])
-AC_CONFIG_FILES([src/mochiweb/Makefile])
-AC_CONFIG_FILES([src/snappy/Makefile])
-AC_CONFIG_FILES([src/snappy/google-snappy/snappy-stubs-public.h])
 AC_CONFIG_FILES([src/ejson/Makefile])
 AC_CONFIG_FILES([test/Makefile])
 AC_CONFIG_FILES([test/bench/Makefile])
diff --git a/src/Makefile.am b/src/Makefile.am
index 047f1ee..c6126fc 100644
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -10,4 +10,4 @@
 ## License for the specific language governing permissions and limitations under
 ## the License.
 
-SUBDIRS = couchdb ejson erlang-oauth etap ibrowse mochiweb snappy
+SUBDIRS = couchdb ejson
diff --git a/src/ejson/Makefile.am b/src/ejson/Makefile.am
index c1e07db..6f2dfaa 100644
--- a/src/ejson/Makefile.am
+++ b/src/ejson/Makefile.am
@@ -44,15 +44,11 @@ EJSON_C_HDRS = \
 
 ejson_file_collection = \
     ejson.app.in \
-    ejson.erl \
-    mochijson2.erl \
-    mochinum.erl
+    ejson.erl
 
 ejsonebin_make_generated_file_list = \
     ejson.app \
-    ejson.beam \
-    mochijson2.beam \
-    mochinum.beam
+    ejson.beam
 
 EXTRA_DIST = \
 	$(EJSON_C_HDRS) \
diff --git a/test/etap/test_util.erl.in b/test/etap/test_util.erl.in
index f17be20..85644dc 100644
--- a/test/etap/test_util.erl.in
+++ b/test/etap/test_util.erl.in
@@ -23,8 +23,7 @@ builddir() ->
     "@abs_top_builddir@".
 
 init_code_path() ->
-    Paths = ["etap", "couchdb", "ejson", "erlang-oauth", "ibrowse", "mochiweb",
-             "snappy"],
+    Paths = ["couchdb", "ejson"],
     lists:foreach(fun(Name) ->
         code:add_patha(filename:join([builddir(), "src", Name]))
     end, Paths).
-- 
1.7.12.1

